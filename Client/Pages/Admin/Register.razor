@page "/register"
@using MoysIQPlatform.Client.Services.EmployeeService
@using MoysIQPlatform.Shared.Models.Accounts
@inject IEmployeeService AuthService
@inject NavigationManager Nav

<h3>Employee Registration</h3>

@if (!string.IsNullOrWhiteSpace(Message))
{
	<p>@Message</p>
}

<EditForm Model="registerModel" OnValidSubmit="HandleRegister">
	<DataAnnotationsValidator />
	<ValidationSummary />

	<InputText @bind-Value="registerModel.FullName" placeholder="Full Name" class="form-control mb-2" />
	<InputText @bind-Value="registerModel.Email" placeholder="Email" class="form-control mb-2" />
	<InputText @bind-Value="registerModel.Password" type="password" placeholder="Password" class="form-control mb-2" />
	<InputText @bind-Value="registerModel.ConfirmPassword" type="password" placeholder="Confirm Password" class="form-control mb-2" />
	<InputText @bind-Value="registerModel.Department" placeholder="Department" class="form-control mb-2" />
	<InputText @bind-Value="registerModel.WorkLocation" placeholder="Work Location" class="form-control mb-2" />
	<InputText @bind-Value="registerModel.PhoneNumber" placeholder="Phone Number" class="form-control mb-2" />
	<InputText @bind-Value="registerModel.Gender" placeholder="Gender" class="form-control mb-2" />
	<InputText @bind-Value="registerModel.Role" placeholder="Role" class="form-control mb-2" />

	<button type="submit" class="btn btn-primary">Register</button>
</EditForm>

@code {
	private EmployeeRegister registerModel = new();
	private string? Message;

	private async Task HandleRegister()
	{
		var result = await AuthService.Register(registerModel);
		Message = result.Message;

		if (result.Success)
		{
			Nav.NavigateTo("/");
		}
	}
}
